<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.suneee.eas.oa.dao.car.CarAuditDao">    <select id="findById" resultType="carAudit">        SELECT * FROM oa_car_audit where auditId=#{id}    </select>    <select id="listAll" resultType="carAudit">        SELECT * FROM oa_car_audit        <where>            <if test="@Ognl@isNotEmpty(targetId)">                AND targetId= #{targetId}            </if>        </where>        ORDER BY auditId DESC    </select>    <select id="auditList" resultType="carApply">    SELECT ca.*,rt.TASK_DEF_KEY_ as currentNode FROM act_ru_task rt left join oa_car_apply ca on rt.ID_=ca.taskId where rt.ASSIGNEE_=#{userId} and ca.status=#{status}        <if test="@Ognl@isNotEmpty(enterpriseCode)">            AND ca.enterpriseCode= #{enterpriseCode}        </if>        <if test="@Ognl@isNotEmpty(content)">            AND ca.content like #{content}        </if>        <if test="@Ognl@isNotEmpty(origin)">            AND ca.origin like #{origin}        </if>        <if test="@Ognl@isNotEmpty(destination)">            AND ca.destination like #{destination}        </if>        <if test="@Ognl@isNotEmpty(passengerCount)">            AND ca.passengerCount= #{passengerCount}        </if>        <if test="@Ognl@isNotEmpty(beginUseTime)">            AND ca.startTime>=#{beginUseTime}        </if>        <if test="@Ognl@isNotEmpty(endUseTime)">            <![CDATA[AND ca.startTime<= #{endUseTime}]]>        </if>        <if test="@Ognl@isNotEmpty(beginCreateTime)">            AND ca.createTime>=#{beginCreateTime}        </if>        <if test="@Ognl@isNotEmpty(endCreateTime)">            <![CDATA[AND ca.createTime<= #{endCreateTime}]]>        </if>        <if test="@Ognl@isNotEmpty(searchCondition)">            AND (ca.origin like #{searchCondition}            or ca.applicantName like #{searchCondition})        </if>        ORDER BY rt.CREATE_TIME_ DESC    </select>    <select id="auditHisList" resultType="carApply">        SELECT b.*,a.auditStatus,a.nodeName as currentNode,a.auditorId as assigneeId,        a.auditorName as assigneeName        FROM oa_car_audit a        left join oa_car_apply b on a.procInstId=b.procInstId        where a.auditorId=#{userId}        AND (a.auditStatus=1 or a.auditStatus=2)        <if test="@Ognl@isNotEmpty(enterpriseCode)">            AND b.enterpriseCode= #{enterpriseCode}        </if>        <if test="@Ognl@isNotEmpty(content)">            AND b.content like #{content}        </if>        <if test="@Ognl@isNotEmpty(origin)">            AND b.origin like #{origin}        </if>        <if test="@Ognl@isNotEmpty(destination)">            AND b.destination like #{destination}        </if>        <if test="@Ognl@isNotEmpty(passengerCount)">            AND b.passengerCount= #{passengerCount}        </if>        <if test="@Ognl@isNotEmpty(beginUseTime)">            AND b.startTime>=#{beginUseTime}        </if>        <if test="@Ognl@isNotEmpty(endUseTime)">            <![CDATA[AND b.startTime<= #{endUseTime}]]>        </if>        <if test="@Ognl@isNotEmpty(beginCreateTime)">            AND b.createTime>=#{beginUseTime}        </if>        <if test="@Ognl@isNotEmpty(endCreateTime)">            <![CDATA[AND b.createTime<= #{endCreateTime}]]>        </if>        <if test="@Ognl@isNotEmpty(searchCondition)">            AND (b.origin like #{searchCondition}            or b.applicantName like #{searchCondition})        </if>        ORDER BY a.endTime DESC    </select>    <insert id="save">        INSERT INTO oa_car_audit(auditId,targetId,auditorId,auditorName,auditStatus,nodeName,isRead, opinion, startTime, endTime, duration,procInstId) VALUES(#{auditId},#{targetId},#{auditorId},#{auditorName},#{auditStatus},#{nodeName},#{isRead}, #{opinion}, #{startTime}, #{endTime}, #{duration}, #{procInstId})    </insert>    <update id="update">        UPDATE oa_car_audit        <set>            <if test="@Ognl@isNotEmpty(auditorId)">                auditorId=#{auditorId},            </if>            <if test="@Ognl@isNotEmpty(auditorName)">                auditorName=#{auditorName},            </if>            <if test="@Ognl@isNotEmpty(auditStatus)">                auditStatus=#{auditStatus},            </if>            <if test="@Ognl@isNotEmpty(nodeName)">                nodeName=#{nodeName},            </if>            <if test="@Ognl@isNotEmpty(isRead)">                isRead=#{isRead},            </if>            <if test="@Ognl@isNotEmpty(opinion)">                opinion=#{opinion},            </if>            <if test="@Ognl@isNotEmpty(startTime)">                startTime=#{startTime},            </if>            <if test="@Ognl@isNotEmpty(endTime)">                endTime=#{endTime},            </if>            <if test="@Ognl@isNotEmpty(duration)">                duration=#{duration},            </if>        </set>        WHERE auditId=#{auditId}    </update>    <delete id="deleteByTargetId">        DELETE FROM oa_car_audit WHERE targetId=#{targetId}    </delete>    <delete id="deleteByInstId">        DELETE FROM oa_car_audit WHERE procInstId=#{procInstId}    </delete>    <select id="findByApplyId" parameterType="java.lang.Long" resultType="CarAudit">        SELECT * FROM oa_car_audit a        INNER JOIN oa_car_apply b ON a.procInstId = b.procInstId        WHERE b.applyId=#{applyId}    </select>    <select id="list" parameterType="java.util.Map" resultType="CarAudit">    </select></mapper>